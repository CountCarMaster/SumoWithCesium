{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Use correct character set. -->
    <meta charset="utf-8"/>
    <!-- Tell IE to use the latest, best version. -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <title>Hello World!</title>
    <script type="text/javascript" src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'ajax.js' %}"></script>
    <script src="{% static 'Build/Cesium/Cesium.js' %}"></script>
    <style>
        @import url(../static/Build/Cesium/Widgets/widgets.css);

        html,
        body,
        #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
<div id="test"></div>
<div id="cesiumContainer"></div>
<script>

    function sleep(time) {
        return new Promise((resolve) => setTimeout(resolve, time));
    }

    Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4MzM5OTUxNi05NDM1LTRiZjktYTYzZS1jNjdkOGYzODY4MTQiLCJpZCI6MTAyNDg0LCJpYXQiOjE2NTg3NjI5Nzd9.LeY0XxRAw1keEGLweLto2-3HQLLCB3Ulmat8px_u5R8";
    // STEP 4 CODE (replaces steps 2 and 3)

    var viewer = new Cesium.Viewer('cesiumContainer', {
        infoBox: false,
        selectionIndicator: false,
        shadows: true,
        shouldAnimate: true
    });
    // 记录线的坐标，PolyLinePrimitive实体类监听的坐标
    var positions = [];
    // 记录线的所有实体对象
    // 测试实体条数
    var ec = 5;
    // 添加初始化数据（positions、poly）
    for (var i = 0; i < ec; i++) {
        positions.push([]);
    }
    var czml2 = [{
        "id": "document",
        "name": "CZML Path",
        "version": "1.0",
    }, {
        "id": "path1",
        "name": "path with GPS flight data",
        "availability": "2012-08-04T10:00:00Z/2012-08-04T15:00:00Z",
        "billboard": {
            "image": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMy4wLjMsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zyw56m65a+85by5XzFfIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiDQoJIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCgkuc3Qwe3N0cm9rZTojMDAwMEZGO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCgkuc3Qxe2ZpbGw6bm9uZTtzdHJva2U6IzAwMDBGRjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9DQo8L3N0eWxlPg0KPHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSIxNS41LDUuMDQgMTIuNSwxMC4yMyAxOC41LDEwLjIzICIvPg0KPGxpbmUgY2xhc3M9InN0MSIgeDE9IjE1LjUiIHkxPSIxMC41IiB4Mj0iMTUuNSIgeTI9IjI2LjUiLz4NCjxsaW5lIGNsYXNzPSJzdDEiIHgxPSIxMi41IiB5MT0iMjYuNSIgeDI9IjE4LjUiIHkyPSIyNi41Ii8+DQo8bGluZSBjbGFzcz0ic3QxIiB4MT0iMTUuNSIgeTE9IjIwLjUiIHgyPSIxMi41IiB5Mj0iMjMuNSIvPg0KPGxpbmUgY2xhc3M9InN0MSIgeDE9IjE4LjUiIHkxPSIyMy41IiB4Mj0iMTUuNSIgeTI9IjIwLjUiLz4NCjwvc3ZnPg0K",
            "scale": 0.2
        },
        "position": {
            "cartographicDegrees": [118.87826541800007, 30.956799, 0.0,]
        }
    }];
    // 动态赋值
    var i = 30.956800;
    var b = 118.8774481050001;
    var czmlBox = [];
    var dataSourceBox = [];
    var ii = [];
    var bb = [];
    for (var i = 0; i < ec; i++) {
        ii.push(i);
        bb.push(b);
        czmlBox.push(czml2);
        var DataSource = new Cesium.CzmlDataSource();
        viewer.dataSources.add(DataSource.load(czml2));
        dataSourceBox.push(DataSource);
    }
    var realTimeClData = setInterval(function () {
        for (var i = 0; i < ec; i++) {
            ii[i] += 10.001 * Math.random();
            bb[i] += 10.001 * Math.random();
            //图标
            czmlBox[i][1].position.cartographicDegrees = [bb[i], ii[i], 0];
            dataSourceBox[i].process(czmlBox[i]);
        }
    }, 200);
    Sandcastle.addToolbarButton('清除计时器', function () {
        clearInterval(realTimeClData);
    });

</script>
</body>
</html>